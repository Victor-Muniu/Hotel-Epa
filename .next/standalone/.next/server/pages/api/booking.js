"use strict";(()=>{var e={};e.id=183,e.ids=[183],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},691:(e,t,r)=>{r.r(t),r.d(t,{config:()=>m,default:()=>u,routeModule:()=>c});var n={};r.r(n),r.d(n,{default:()=>l});var s=r(1802),o=r(7153),i=r(6249),a=r(5754);function d(e){let t=String(e||"").trim(),r=t.startsWith("+"),n=t.replace(/\D+/g,"");return n?r?`+${n}`:n:""}async function l(e,t){if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({message:"Method Not Allowed"});try{let r=(0,a.S)();if(!r)return t.status(200).json({message:"Received. Configure NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY to store requests."});let n=e.body.first_name||null,s=e.body.last_name||null;e.body.rooms&&e.body.rooms;let o=e.body.guests?Number(e.body.guests):1,i=e.body.children?Number(e.body.children):0,l=String(e.body.start_date||""),u=String(e.body.end_date||""),m=e=>/^\d{4}-\d{2}-\d{2}$/.test(e);if(!m(l)||!m(u))return t.status(400).json({message:"Invalid date format. Use YYYY-MM-DD."});let c=new Date().toISOString().slice(0,10);if(l<c)return t.status(400).json({message:"Check-in date cannot be in the past."});if(u<=l)return t.status(400).json({message:"Check-out must be after check-in."});let b=String(e.body.email||"").trim(),g=String(e.body.phone||"").trim();if(!function(e){let t=String(e||"").trim();return/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(t)}(b))return t.status(400).json({message:"Invalid email address."});if(!function(e){let t=d(e),r=t.startsWith("+")?t.slice(1):t;return!!/^[0-9]+$/.test(r)&&r.length>=7&&r.length<=15}(g))return t.status(400).json({message:"Invalid phone number."});let f=d(g),p=e.body.board_plan,y=[];if(Array.isArray(p))y=p;else if("string"==typeof p)try{y=JSON.parse(p)}catch{y=[]}let _=Array.from(new Set(y.map(e=>String(e.board_type||"").trim()).filter(Boolean))),S=String(e.body.type||""),P=("room"===S.toLowerCase()?e.body.board_type||null:S||e.body.board_type||null)||(_.length<=1?_[0]||null:"mixed"),h=String(e.body.room_id||""),A={room_id:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(h)?h:null,first_name:n,last_name:s,email:b,phone:f,start_date:e.body.start_date,end_date:e.body.end_date,guests:o,children:i,board_type:P||null,board_plan:y,total_price:e.body.total_price||null,currency:"USD",status:"pending",payment_status:"pending",notes:e.body.notes||null,created_at:new Date().toISOString()},{error:I}=await r.from("bookings").insert(A);if(I)return console.error("Bookings insert error:",I),t.status(500).json({message:"Failed to save booking.",details:I.message||String(I)});return t.status(200).json({message:"Booking confirmed! We will contact you soon with details."})}catch(e){return console.error("Booking error:",e),t.status(500).json({message:"Failed to process booking.",details:e?.message||String(e)})}}let u=(0,i.l)(n,"default"),m=(0,i.l)(n,"config"),c=new s.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/booking",pathname:"/api/booking",bundlePath:"",filename:""},userland:n})},5754:(e,t,r)=>{r.d(t,{S:()=>a});let n=require("@supabase/supabase-js"),s="https://uhxofvlffmkrlqvbisil.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVoeG9mdmxmZm1rcmxxdmJpc2lsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU0MzgxMDYsImV4cCI6MjA3MTAxNDEwNn0.ZQDbpQqWb8CVhAjWxdwPr3RH_wDQTChVDplQVd_NlEI",i=null;function a(){return i||s&&o&&(i=(0,n.createClient)(s,o)),i}},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=691);module.exports=r})();